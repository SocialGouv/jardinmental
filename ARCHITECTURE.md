# Jardin Mental - Dossier d'Architecture

## 1. PROJET - ACTEURS

### Nom du projet applicatif

**Jardin Mental**

### Contexte projet applicatif

Les troubles psychiatriques touchent plus de 20 % de la population, Ã  un moment de la vie. Et trouver le bon traitement peut prendre plusieurs annÃ©es. Pendant ce temps-lÃ , les symptÃ´mes Ã©voluent, peuvent devenir chroniques et l'Ã©tat du patient s'aggrave. L'impact peut Ãªtre dramatique.

### Objectifs projet applicatif

Le mÃ©decin choisit ou modifie un traitement en se basant sur ce que lui rapporte la personne durant la consultation. Mais le mÃ©decin n'a que peu de temps avec la personne concernÃ©e et les informations rapportÃ©es ne sont pas fiables.

Les jeunes que nous avons interrogÃ©s rapportent en effet avoir du mal Ã  dire tout ce qu'ils souhaitent en consultation et expliquent repartir en ayant bien souvent omis de transmettre une ou plusieurs informations importantes.

C'est qu'il est trÃ¨s difficile de donner une reprÃ©sentation fiable de ses symptÃ´mes et de l'Ã©volution de ceux-ci.

**Pourquoi ?** Car aucun humain n'est capable de se souvenir fidÃ¨lement de l'Ã©volution de son Ã©tat psychique sur une durÃ©e trop longue.

Il est par exemple quasiment impossible de se rappeler la qualitÃ© de son sommeil 3 semaines auparavant, d'Ãªtre suffisamment prÃ©cis sur le nombre de crise d'angoisse survenues le mois dernier, l'intensitÃ© de celles-ci et leur impact sur notre quotidien, ou encore de se rappeler de ces jours oÃ¹ Ã§a allait vraiment bien, alors que les jours prÃ©cÃ©dant le rendez-vous, la tristesse nous a envahit...

### Enjeux projet applicatif

Plus les informations concernant mes symptÃ´mes sont proches de la rÃ©alitÃ©, de ce que je vis, plus mon mÃ©decin sera en mesure de me prescrire le bon traitement, celui qui sera le plus efficace possible avec le moins d'effets indÃ©sirables.

**Jardin Mental, c'est une aide pour un dialogue continu, qui s'adresse Ã  tous, co-construite avec les usagers, comprenant :**

- La possibilitÃ© de sÃ©lectionner les symptÃ´mes et les effets indÃ©sirables des traitements mÃ©dicaux Ã  suivre
- Un rappel quotidien pour m'aider Ã  y penser
- Des Ã©crans simples permettant une saisie rapide
- Une synthÃ¨se de l'Ã©volution de l'intensitÃ© des symptÃ´mes au cours du temps
- Un accÃ¨s Ã  des donnÃ©es informatives concernant les symptÃ´mes suivis
- Un parcours motivationnel dans la participation Ã  mon suivi

Jardin Mental, c'est permettre aux personnes suivies de rester au plus prÃ¨s de leur expÃ©rience et d'en rendre compte le plus fidÃ¨lement possible au mÃ©decin, pour lui permettre de participer Ã  soulager la souffrance grÃ¢ce Ã  une intervention mÃ©dicamenteuse adÃ©quate, personnalisÃ©e et rapide.

### Planning projet

| Version | Date | Description |
| ------- | ---- | ----------- |
| â€”       | â€”    | â€”           |

### Acteurs Projet

| RÃ´le                   | Nom               | EntitÃ©             |
| ---------------------- | ----------------- | ------------------ |
| Intrapreneur           | â€”                 | â€”                  |
| ChargÃ© de portefeuille | REZGUI Lycia      | Fabrique NumÃ©rique |
| Product Manager        |                   |                    |
| Partie prenante        | â€”                 | â€”                  |
| Designer UX/UI         |                   | â€”                  |
| DÃ©veloppeur            |                   |                    |
| DÃ©veloppeur            | â€”                 | â€”                  |
| DÃ©veloppeur            | â€”                 | â€”                  |
| Equipe plateforme      | VAN-WOERKENS Gary | Fabrique NumÃ©rique |
| Equipe plateforme      | RENQUIN Igor      | Fabrique NumÃ©rique |

### Acteurs mÃ©tiers du SI applicatif

Identifier les profils d'utilisateurs de l'applicatif, leur provenance et leur nombre

| Profils utilisateurs    | MCAS | RIE, intermin | Externe | Public |
| ----------------------- | ---- | ------------- | ------- | ------ |
| Equipe Produit          | â€”    | â€”             | X       | â€”      |
| Citoyens                | â€”    | â€”             | â€”       | X      |
| Patients                | â€”    | â€”             | â€”       | X      |
| Professionnels de santÃ© | â€”    | â€”             | â€”       | â€”      |

---

## 2. FONCTIONNALITES â€“ DONNEES

### FonctionnalitÃ©s du SI Applicatif

#### FonctionnalitÃ©s du SI Applicatif - Site Ã©ditorial

| FonctionnalitÃ©s          | MCAS | RIE, intermin | Externe | Public |
| ------------------------ | ---- | ------------- | ------- | ------ |
| Informations Ã©ditoriales | â€”    | â€”             | â€”       | X      |

#### FonctionnalitÃ©s du SI Applicatif - Statistiques

| FonctionnalitÃ©s                                                                                                                              | MCAS | RIE, intermin | Externe | Public |
| -------------------------------------------------------------------------------------------------------------------------------------------- | ---- | ------------- | ------- | ------ |
| Analyse de la donnÃ©e d'usage de l'application par l'utilisateur (du parcours utilisateur dans l'application, nb connexion, type de terminal) | â€”    | â€”             | X       | â€”      |

#### FonctionnalitÃ©s du SI Applicatif - Application Mobile

| FonctionnalitÃ©s                                                                                                                               | MCAS | RIE, intermin | Externe | Public |
| --------------------------------------------------------------------------------------------------------------------------------------------- | ---- | ------------- | ------- | ------ |
| Un questionnaire entiÃ¨rement paramÃ©trable permettant aux usagers de suivre l'ensemble des critÃ¨res de leurs choix ainsi que leurs traitements | â€”    | â€”             | â€”       | X      |
| Les colonnes de beck : un exercice de psychothÃ©rapie                                                                                          | â€”    | â€”             | â€”       | X      |
| Les analyses : un ensemble de vue permettant d'avoir une analyse des donnÃ©es renseignÃ©es                                                      | â€”    | â€”             | â€”       | X      |
| Des notes : permettant Ã  l'usagers de renseigner des Ã©lÃ©ments pour une journÃ©e donnÃ©e sous forme de texte libre                               | â€”    | â€”             | â€”       | X      |
| L'export de donnÃ©es : sous forme d'e-mail vers un destinataire au choix                                                                       | â€”    | â€”             | â€”       | X      |
| Un module de retour utilisateur                                                                                                               | â€”    | â€”             | â€”       | X      |
| Se fixer et suivre des objectifs Ã  rÃ©aliser                                                                                                   | â€”    | â€”             | â€”       | X      |
| Demande sur les consommations, addictions                                                                                                     | â€”    | â€”             | â€”       | X      |

### DonnÃ©es mÃ©tier du SI Applicatif

| DonnÃ©es mÃ©tier du SI Applicatif | MCAS | RIE, intermin | Externe | Public |
| ------------------------------- | ---- | ------------- | ------- | ------ |
| â€”                               | â€”    | â€”             | â€”       | â€”      |

### RÃ©fÃ©rentiel de donnÃ©es hors SI Applicatif

| Fichiers mÃ©tier du SI Applicatif | MCAS | RIE, intermin | Externe | Public |
| -------------------------------- | ---- | ------------- | ------- | ------ |
| â€”                                | â€”    | â€”             | â€”       | â€”      |

### SensibilitÃ© des donnÃ©es dans le SI Applicatif

#### SensibilitÃ© des donnÃ©es - Site Ã©ditoriale

| Type de donnÃ©es trÃ¨s sensible | PrÃ©sence | Type de donnÃ©es Sensible | PrÃ©sence | Type de donnÃ©es Public    | PrÃ©sence |
| ----------------------------- | -------- | ------------------------ | -------- | ------------------------- | -------- |
| NIR                           | â€”        | Architecture technique   | â€”        | Editoriaux                | X        |
| MÃ©dicales                     | â€”        | Organisationnel          | â€”        | Publication extranet      | â€”        |
| Vie PrivÃ©e                    | â€”        | Etat civil               | â€”        | Campagne de communication | â€”        |
| Justice                       | â€”        | Adresse postale          | â€”        | Statistiques publiables   | X        |
| IdentitÃ©                      | â€”        | Vie personnelle          | â€”        |                           |          |
| BiomÃ©trique                   | â€”        | Vie professionnelle      | â€”        |                           |          |
| MÃ©canisme de fraude           | â€”        | Mouvements salariaux     | â€”        |                           |          |
| Architecture SÃ©curisÃ©         | â€”        | SantÃ© Ã©conomique         | â€”        |                           |          |
| Failles & VulnÃ©rabilitÃ©       | â€”        |                          |          |                           |          |
| Patrimoine                    | â€”        |                          |          |                           |          |
| Appartenance syndicale        | â€”        |                          |          |                           |          |

#### SensibilitÃ© des donnÃ©es - Statistiques

| Type de donnÃ©es trÃ¨s sensible | PrÃ©sence | Type de donnÃ©es Sensible | PrÃ©sence | Type de donnÃ©es Public    | PrÃ©sence |
| ----------------------------- | -------- | ------------------------ | -------- | ------------------------- | -------- |
| NIR                           | â€”        | Architecture technique   | â€”        | Editoriaux                | â€”        |
| MÃ©dicales                     | â€”        | Organisationnel          | â€”        | Publication extranet      | â€”        |
| Vie PrivÃ©e                    | â€”        | Etat civil               | â€”        | Campagne de communication | â€”        |
| Justice                       | â€”        | Adresse postale          | â€”        | Statistiques publiables   | â€”        |
| IdentitÃ©                      | â€”        | Vie personnelle          | â€”        |                           |          |
| BiomÃ©trique                   | â€”        | Vie professionnelle      | â€”        |                           |          |
| MÃ©canisme de fraude           | â€”        | Mouvements salariaux     | â€”        |                           |          |
| Architecture SÃ©curisÃ©         | â€”        | SantÃ© Ã©conomique         | â€”        |                           |          |
| Failles & VulnÃ©rabilitÃ©       | â€”        |                          |          |                           |          |
| Patrimoine                    | â€”        |                          |          |                           |          |
| Appartenance syndicale        | â€”        |                          |          |                           |          |

#### SensibilitÃ© des donnÃ©es - Application mobile

| Type de donnÃ©es trÃ¨s sensible | PrÃ©sence | Type de donnÃ©es Sensible | PrÃ©sence | Type de donnÃ©es Public    | PrÃ©sence |
| ----------------------------- | -------- | ------------------------ | -------- | ------------------------- | -------- |
| NIR                           | â€”        | Architecture technique   | â€”        | Editoriaux                | â€”        |
| **MÃ©dicales**                 | **X**    | Organisationnel          | â€”        | Publication extranet      | â€”        |
| **Vie PrivÃ©e**                | **X**    | Etat civil               | â€”        | Campagne de communication | â€”        |
| Justice                       | â€”        | Adresse postale          | â€”        | Statistiques publiables   | â€”        |
| IdentitÃ©                      | â€”        | Vie personnelle          | â€”        |                           |          |
| BiomÃ©trique                   | â€”        | Vie professionnelle      | â€”        |                           |          |
| MÃ©canisme de fraude           | â€”        | Mouvements salariaux     | â€”        |                           |          |
| Architecture SÃ©curisÃ©         | â€”        | SantÃ© Ã©conomique         | â€”        |                           |          |
| Failles & VulnÃ©rabilitÃ©       | â€”        |                          |          |                           |          |
| Patrimoine                    | â€”        |                          |          |                           |          |
| Appartenance syndicale        | â€”        |                          |          |                           |          |

### Services utilisÃ©s par l'application

| Services utilisÃ©s par l'application | Mode d'Ã©change | MCAS | RIE, intermin | Externe | Public |
| ----------------------------------- | -------------- | ---- | ------------- | ------- | ------ |
| TIPIMAIL                            | SMTP           | â€”    | â€”             | X       | â€”      |

---

## 3. CONTRAINTES â€“ VOLUMETRIE

### Contraintes lÃ©gales

Ã€ complÃ©ter

### Contraintes mÃ©tiers

Ã€ complÃ©ter

### Normes et rÃ¨gles Ã  respecter

| Norme    | Description                                             |
| -------- | ------------------------------------------------------- |
| **RGPD** | RÃ¨glement GÃ©nÃ©ral sur la Protection des DonnÃ©es         |
| **RGAA** | RÃ©fÃ©rentiel GÃ©nÃ©ral d'AccessibilitÃ© des Administrations |
| **RGS**  | RÃ©fÃ©rentiel GÃ©nÃ©ral de SÃ©curitÃ©                         |
| **RGI**  | RÃ©fÃ©rentiel GÃ©nÃ©ral d'InteropÃ©rabilitÃ©                  |

### DÃ©pendances avec d'autres SI

| Nom du SI Applicatif | Fournisseur | Consommateur |
| -------------------- | ----------- | ------------ |
| â€”                    | â€”           | â€”            |

### DÃ©pendances avec le poste de travail

| DÃ©pendance avec le terminal utilisateur | Composant    |
| --------------------------------------- | ------------ |
| O.S.                                    | Android, iOS |
| Navigateur                              | â€”            |
| Suite bureautique                       | â€”            |
| Plugin, Addin                           | â€”            |
| PÃ©riphÃ©rique                            | â€”            |

### VolumÃ©trie donnÃ©es du SI Applicatif

| ID  | Description                                   | Valeur |
| --- | --------------------------------------------- | ------ |
| D1  | Nombre d'enregistrements Ã  rÃ©cupÃ©rer          | â€”      |
| D2  | Nombre enregistrements par an                 | â€”      |
| D3  | Taille moyenne enregistrement (Ko)            | â€”      |
| D4  | Nombre d'annÃ©es enregistrements en base (BDD) | â€”      |
| D5  | Volume BDD initial (Go) = (D1 x D3) / 1024Â²   | â€”      |
| D6  | Volume BDD Annuel (Go) = (D2 x D3) / 1024Â²    | â€”      |
| D7  | Volume BDD Total (Go) = (D4 x D6) + D5        | â€”      |

### VolumÃ©trie fichiers du SI Applicatif

| ID  | Description                                  | Valeur |
| --- | -------------------------------------------- | ------ |
| F1  | Nombre de fichiers Ã  rÃ©cupÃ©rer               | â€”      |
| F2  | Nombre de fichiers par an                    | â€”      |
| F3  | Taille moyenne des fichiers (Mo)             | â€”      |
| F4  | Nombre d'annÃ©es fichiers en File System (FS) | â€”      |
| F5  | Volume FS initial (Go) = (F1 x F3) / 1024Â²   | â€”      |
| F6  | Volume Annuel (Go) = (F2 x F3) / 1024Â²       | â€”      |
| F7  | Volume FS Total (Go) = (F4 x F6) + F5        | â€”      |

### RÃ©duction volume de donnÃ©es

- Purge de donnÃ©es dans BDD Applicatif
- Purge fichier dans FS Applicatif
- Archivage donnÃ©es hors Applicatif
- Archivage fichiers hors Applicatif

---

## 4. EXIGENCES NON FONCTIONNELLES

### Exigences sur les donnÃ©es

| Exigence                    | Objectif, Score visÃ© | Moyens Ã  mettre en Å“uvre                                |
| --------------------------- | -------------------- | ------------------------------------------------------- |
| Exigence de DisponibilitÃ©   | â€”                    | â€”                                                       |
| Exigence d'IntÃ©gritÃ©        | â€”                    | ContrÃ´les d'intÃ©gritÃ© sur les donnÃ©es sensibles         |
| Exigence de ConfidentialitÃ© | â€”                    | DonnÃ©es mÃ©dicales et privÃ©es protÃ©gÃ©es, accÃ¨s restreint |
| Exigence de TraÃ§abilitÃ©     | â€”                    | Monitoring via Sentry, logs applicatifs                 |

| Information                            | Valeur       |
| -------------------------------------- | ------------ |
| Liens vers Ã©tude AIPD                  | â€”            |
| Lins vers analyse de Risque (EBIOS RM) | â€”            |
| AQSSI                                  | Ã€ renseigner |
| Responsable de traitement              | Ã€ renseigner |
| HomologuÃ© RGS                          | Ã€ renseigner |
| Date d'homologation                    | Ã€ renseigner |
| DurÃ©e d'homologation                   | Ã€ renseigner |
| Lien vers le dossier d'homologation    | Ã€ renseigner |

### PÃ©riode de service, Garantie de service, Performance

#### Site Jardin mental site Ã©ditorial

**PÃ©riode de service**

| PÃ©riode  | Date dÃ©but | Date fin | NBC | NBS |
| -------- | ---------- | -------- | --- | --- |
| Standard | Lundi      | dimanche | â€”   | â€”   |
| Critique | â€”          | â€”        | â€”   | â€”   |
| Charge   | â€”          | â€”        | â€”   | â€”   |

Description de la charge : â€”

**Garantie de service**

| Application mÃ©tier                       | Application | Standard |
| ---------------------------------------- | ----------- | -------- |
| Plage de Services InfogÃ©rance            | â€”           | â€”        |
| Perte de DonnÃ©es maximale Admissible     | 48h         | â€”        |
| DurÃ©e Maximale d'Interruption Admissible | 48h         | â€”        |

| Impact                                         | Description                                                                                                                       |
| ---------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| Impact MÃ©tier en cas de perte de donnÃ©es       | **Faible :** les stores applicatifs (google et apple) publient les mÃªmes info que le site Ã©ditorial                               |
| Impact MÃ©tier en cas de dÃ©faillance du service | **Faible :** Perte de visibilitÃ© sur l'accÃ¨s Ã  l'application mobile et les informations gÃ©nÃ©rales proposÃ©es par le site Ã©ditorial |

**Performance**

| Temps de rÃ©ponse            | PÃ©riode Standard | PÃ©riode de charge |
| --------------------------- | ---------------- | ----------------- |
| Affichage Page d'accueil    | â€”                | â€”                 |
| Affichage page simple       | â€”                | â€”                 |
| Affichage page complexe     | â€”                | â€”                 |
| Traitement requÃªte simple   | â€”                | â€”                 |
| Traitement requÃªte complexe | â€”                | â€”                 |

**ExploitabilitÃ©**

| Batch applicatif | Plage d'exÃ©cution | FrÃ©quence | Impact mÃ©tier | Impact charge |
| ---------------- | ----------------- | --------- | ------------- | ------------- |
| N/A              | â€”                 | â€”         | N/A           | N/A           |

#### Site Jardin mental Applicatif

**PÃ©riode de service**

| PÃ©riode  | Date dÃ©but | Date fin | NBC | NBS |
| -------- | ---------- | -------- | --- | --- |
| Standard | â€”          | â€”        | â€”   | â€”   |
| Critique | â€”          | â€”        | â€”   | â€”   |
| Charge   | â€”          | â€”        | â€”   | â€”   |

Description de la charge : â€”

**Garantie de service**

| Application mÃ©tier                       | Application | Standard |
| ---------------------------------------- | ----------- | -------- |
| Plage de Services InfogÃ©rance            | â€”           | â€”        |
| Perte de DonnÃ©es maximale Admissible     | â€”           | â€”        |
| DurÃ©e Maximale d'Interruption Admissible | â€”           | â€”        |

| Impact                                         | Description |
| ---------------------------------------------- | ----------- |
| Impact MÃ©tier en cas de perte de donnÃ©es       | â€”           |
| Impact MÃ©tier en cas de dÃ©faillance du service | â€”           |

**Performance**

| Temps de rÃ©ponse            | PÃ©riode Standard | PÃ©riode de charge |
| --------------------------- | ---------------- | ----------------- |
| Affichage Page d'accueil    | â€”                | â€”                 |
| Affichage page simple       | â€”                | â€”                 |
| Affichage page complexe     | â€”                | â€”                 |
| Traitement requÃªte simple   | â€”                | â€”                 |
| Traitement requÃªte complexe | â€”                | â€”                 |

**ExploitabilitÃ©**

| Batch applicatif | Plage d'exÃ©cution | FrÃ©quence | Impact mÃ©tier | Impact charge |
| ---------------- | ----------------- | --------- | ------------- | ------------- |
| â€”                | â€”                 | â€”         | â€”             | â€”             |

#### Site Jardin mental Statistiques

**PÃ©riode de service**

| PÃ©riode  | Date dÃ©but | Date fin | NBC | NBS |
| -------- | ---------- | -------- | --- | --- |
| Standard | Lundi      | Vendredi | 5   | â€”   |
| Critique | â€”          | â€”        | â€”   | â€”   |
| Charge   | â€”          | â€”        | â€”   | â€”   |

Description de la charge : â€”

**Garantie de service**

| Application mÃ©tier                       | Application | Standard |
| ---------------------------------------- | ----------- | -------- |
| Plage de Services InfogÃ©rance            | â€”           | â€”        |
| Perte de DonnÃ©es maximale Admissible     | 48h         | â€”        |
| DurÃ©e Maximale d'Interruption Admissible | 48h         | â€”        |

| Impact                                         | Description                                                                  |
| ---------------------------------------------- | ---------------------------------------------------------------------------- |
| Impact MÃ©tier en cas de perte de donnÃ©es       | **Faible :** Les statistiques d'usages se calculent sur des pÃ©riodes longues |
| Impact MÃ©tier en cas de dÃ©faillance du service | **Faible :** Les statistiques d'usages se calculent sur des pÃ©riodes longues |

**Performance**

| Temps de rÃ©ponse            | PÃ©riode Standard | PÃ©riode de charge |
| --------------------------- | ---------------- | ----------------- |
| Affichage Page d'accueil    | â€”                | â€”                 |
| Affichage page simple       | â€”                | â€”                 |
| Affichage page complexe     | â€”                | â€”                 |
| Traitement requÃªte simple   | â€”                | â€”                 |
| Traitement requÃªte complexe | â€”                | â€”                 |

**ExploitabilitÃ©**

| Batch applicatif | Plage d'exÃ©cution | FrÃ©quence | Impact mÃ©tier | Impact charge |
| ---------------- | ----------------- | --------- | ------------- | ------------- |
| â€”                | â€”                 | â€”         | â€”             | â€”             |

---

## 5. ARCHITECTURE ACTEURS ET PROCESSUS

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Citoyens  â”‚              â”‚   Patients  â”‚
                  â”‚     ğŸ‘¥      â”‚              â”‚     ğŸ‘¥      â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                            â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚          Jardin Mental                      â”‚
                 â”‚                                             â”‚
                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
                 â”‚  â”‚              â”‚    â”‚              â”‚      â”‚
                 â”‚  â”‚ Site public  â”‚    â”‚ Application  â”‚      â”‚
                 â”‚  â”‚              â”‚    â”‚   mobile     â”‚      â”‚
                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                 â”‚                                             â”‚
                 â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
                 â”‚                      â”‚              â”‚      â”‚
                 â”‚                      â”‚ Statistiques â”‚â—„â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ ğŸ‘¥ Equipe produit
                 â”‚                      â”‚              â”‚      â”‚
                 â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                 â”‚                                             â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Version Mermaid :**

```mermaid
graph TB
    subgraph Utilisateurs
        Citoyens[ğŸ‘¥ Citoyens]
        Patients[ğŸ‘¥ Patients]
        Equipe[ğŸ‘¥ Equipe produit]
    end
    subgraph JardinMental["Jardin Mental"]
        SitePublic[Site public]
        AppMobile[Application mobile]
        Stats[Statistiques]

    end
    Citoyens --> SitePublic
    Patients --> AppMobile
    Equipe --> Stats
    style JardinMental fill:#e1f5e1,color:#000000
    style Utilisateurs fill:#f0f0f0,color:#000000
```

---

## 6. ARCHITECTURE FONCTIONNELLE

```
                     ğŸ‘¥                                  ğŸ‘¥
                  Patients                            Citoyens
                     â”‚                                    â”‚
                     â–¼                                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Application Mobile       â”‚     â”‚  Jardin Mental - Site      â”‚
        â”‚                            â”‚     â”‚      Editorial             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Un questionnaire entiÃ¨re-  â”‚     â”‚                            â”‚
        â”‚ ment paramÃ©trable permet-  â”‚     â”‚  Informations Ã©ditoriales  â”‚
        â”‚ tant aux usagers de suivre â”‚     â”‚                            â”‚
        â”‚ l'ensemble des critÃ¨res de â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ leurs choix ainsi que      â”‚                  â”‚
        â”‚ leurs traitements          â”‚                  â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
        â”‚ Les colonnes de beck :     â”‚                  â–¼
        â”‚ un exercice de thÃ©rapie    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ psychothÃ©rapie             â”‚     â”‚      Statistiques          â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚                            â”‚
        â”‚ Des notes : permettant Ã    â”‚     â”‚  Consultation statistique  â”‚
        â”‚ l'usagers de renseigner    â”‚     â”‚  d'utilisation de          â”‚
        â”‚ des Ã©lÃ©ments pour une      â”‚     â”‚  l'application             â”‚
        â”‚ journÃ©e donnÃ©e sous forme  â”‚     â”‚                            â”‚
        â”‚ de texte libre             â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
        â”‚ Envoi par e-mail des       â”‚                   â”‚
        â”‚ donnÃ©es renseignÃ©es vers   â”‚                   â–¼
        â”‚ un destinataire             â”‚              ğŸ‘¥
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           Equipe produit
        â”‚ Un module de retour        â”‚
        â”‚ utilisateur                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Version Mermaid :**

```mermaid
graph LR
    subgraph Utilisateurs
        Patients[ğŸ‘¥ Patients]
        Citoyens[ğŸ‘¥ Citoyens]
        Equipe[ğŸ‘¥ Equipe produit]
    end

    subgraph SiteEditorial["Site Editorial"]
        InfoEdit[Informations Ã©ditoriales]
    end

    subgraph AppMobile["Application Mobile"]
        Questionnaire[Questionnaire paramÃ©trable<br/>suivi symptÃ´mes et traitements]
        Beck[Colonnes de Beck<br/>exercice psychothÃ©rapie]
        Notes[Notes journaliÃ¨res<br/>texte libre]
        Export[Export e-mail<br/>des donnÃ©es]
        Retour[Module retour<br/>utilisateur]
    end

    subgraph Stats["Statistiques"]
        ConsultStats[Consultation statistique<br/>d'utilisation]
    end

    Patients --> Questionnaire
    Patients --> Beck
    Patients --> Notes
    Patients --> Export
    Patients --> Retour
    Citoyens --> InfoEdit
    Equipe --> ConsultStats

    style AppMobile fill:#e1f5e1
    style SiteEditorial fill:#e1f5e1
    style Stats fill:#ffe1cc
```

---

## 7. ARCHITECTURE APPLICATIVE

```
          ğŸ‘¥                            ğŸ‘¥                      ğŸ‘¥
       Citoyens                     Patients              Equipe produit
          â”‚                            â”‚                        â”‚
          â”‚                            â”‚                        â”‚
          â–¼                            â–¼                        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚             â”‚            â”‚  Application    â”‚      â”‚             â”‚
   â”‚ Application â”‚            â”‚    mobile       â”‚      â”‚    Oauth    â”‚
   â”‚             â”‚            â”‚  Android, iOS   â”‚      â”‚             â”‚
   â”‚   (JS)      â”‚            â”‚                 â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
   â”‚             â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚                      â”‚
          â”‚                            â”‚                      â”‚
          â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚      â”‚                     â”‚
          â”‚      â”‚                     â–¼
          â”‚      â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚      â”‚            â”‚  Application API â”‚
          â”‚      â”‚            â”‚                  â”‚
          â”‚      â”‚            â”‚       (JS)       â”‚
          â”‚      â”‚            â”‚                  â”‚
          â”‚      â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚      â”‚                     â”‚
          â”‚      â”‚                     â”‚
          â”‚      â”‚                     â–¼
          â”‚      â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚      â”‚            â”‚  PostgreSQL      â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”      â”‚                  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    â”‚      â”‚  Jardin Mentale  â”‚      â”‚             â”‚
  â”‚ Notification SMTP  â”‚â—„â”€â”€â”€â”€â”€â”¤  - Applicatif    â”‚â”€â”€â”€â”€â”€â–ºâ”‚  Metabase   â”‚
  â”‚   (Tipimail)       â”‚      â”‚                  â”‚      â”‚             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚                        â”‚
                                       â”‚                        â”‚
                                       â–¼                        â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
                              â”‚   PostgreSQL     â”‚              â”‚
                              â”‚                  â”‚              â”‚
                              â”‚  Jardin Mentale  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚  - Statistiques  â”‚
                              â”‚                  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Version Mermaid :**

```mermaid
graph TB
    subgraph Utilisateurs
        Citoyens[ğŸ‘¥ Citoyens]
        Patients[ğŸ‘¥ Patients]
        EquipeProduit[ğŸ‘¥ Equipe produit]
    end

    subgraph External["Services Externes"]
        Tipimail[ğŸ“§ Tipimail<br/>Notification SMTP]
    end

    AppSitePublic[Application<br/>Site Public<br/>JS]
    AppMobile[Application mobile<br/>Android, iOS]
    Oauth[Oauth]

    API[Application API<br/>JS]
    BDD1[(PostgreSQL<br/>Jardin Mentale<br/>Applicatif)]

    Metabase[Metabase]
    BDD2[(PostgreSQL<br/>Jardin Mentale<br/>Statistiques)]

    Citoyens --> AppSitePublic
    Patients --> AppMobile
    EquipeProduit --> Oauth

    AppSitePublic --> API
    AppMobile --> API
    Oauth --> Metabase

    API --> BDD1
    API --> Tipimail

    Metabase --> BDD2
    BDD1 -.sync.-> BDD2

    style AppSitePublic fill:#e1f5e1
    style AppMobile fill:#e1f5e1
    style API fill:#e1f5e1
    style BDD1 fill:#cce5ff
    style BDD2 fill:#cce5ff
    style Metabase fill:#ffe1cc
    style External fill:#fff4e1
```

---

## 8. ARCHITECTURE TECHNIQUE

```
                      ğŸ“±
                 Application mobile
                  Android, iOS          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  ğŸ“Š Sentry
                       â”‚
      ğŸ‘¥          ğŸ‘¥   â”‚       ğŸ‘¥
   Citoyens   Patients â”‚   Equipe produit              â”€â”€â–º  ğŸ“ˆ Matomo
       â”‚          â”‚    â”‚       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                     â”€â”€â–º  ğŸ“§ Tipimail
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Internet     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â˜¸                                                            â”‚
    â”‚  Kubernetes                                                   â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚  Plateforme                                            â”‚  â”‚
    â”‚  â”‚                                                         â”‚  â”‚
    â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
    â”‚  â”‚   â”‚ GTW  â”‚â”€â”€â”€â”€â”€â–ºâ”‚ LB â”‚â”€â”€â”€â”€â”€â–ºâ”‚ Ingress Nginxâ”‚          â”‚  â”‚
    â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
    â”‚  â”‚                                     â”‚                  â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                        â”‚                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚                                    â–¼                  â”‚  â”‚
    â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
    â”‚   â”‚  â”‚          â”‚   â”‚          â”‚   â”‚          â”‚         â”‚  â”‚
    â”‚   â”‚  â”‚   APP    â”‚   â”‚   API    â”‚   â”‚  Oauth   â”‚         â”‚  â”‚
    â”‚   â”‚  â”‚   (JS)   â”‚   â”‚   (JS)   â”‚   â”‚          â”‚         â”‚  â”‚
    â”‚   â”‚  â”‚          â”‚   â”‚          â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
    â”‚   â”‚  â”‚          â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚               â”‚  â”‚
    â”‚   â”‚  â”‚Jardin    â”‚        â”‚              â”‚               â”‚  â”‚
    â”‚   â”‚  â”‚mentale   â”‚        â”‚              â–¼               â”‚  â”‚
    â”‚   â”‚  â”‚site      â”‚        â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
    â”‚   â”‚  â”‚public    â”‚        â”‚       â”‚              â”‚       â”‚  â”‚
    â”‚   â”‚  â”‚          â”‚        â”‚       â”‚   Metabase   â”‚       â”‚  â”‚
    â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚       â”‚              â”‚       â”‚  â”‚
    â”‚   â”‚                      â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
    â”‚   â”‚                      â–¼              â”‚               â”‚  â”‚
    â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚               â”‚  â”‚
    â”‚   â”‚              â”‚            â”‚         â”‚               â”‚  â”‚
    â”‚   â”‚              â”‚  BDD       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚
    â”‚   â”‚              â”‚ PostgreSQL â”‚                         â”‚  â”‚
    â”‚   â”‚              â”‚            â”‚                         â”‚  â”‚
    â”‚   â”‚              â”‚Jardin      â”‚                         â”‚  â”‚
    â”‚   â”‚              â”‚mentale     â”‚                         â”‚  â”‚
    â”‚   â”‚              â”‚Statistiquesâ”‚                         â”‚  â”‚
    â”‚   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
    â”‚   â”‚                                                     â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**LÃ©gende des flux :**

1. APP (Site public)
2. API accÃ¨s
3. API â†” BDD
4. Oauth Proxy accÃ¨s
5. Oauth â†” Metabase
6. Metabase â†” BDD
7. API â†’ Tipimail (SMTP)
8. API â†’ Matomo

**Version Mermaid :**

```mermaid
graph TB
    subgraph Utilisateurs
        Citoyens[ğŸ‘¥ Citoyens]
        Patients[ğŸ‘¥ Patients]
        EquipeProduit[ğŸ‘¥ Equipe produit]
        AppMobile[ğŸ“± Application mobile<br/>Android, iOS]
    end

    subgraph ServicesExternes["Services Externes"]
        Sentry[ğŸ“Š Sentry]
        Matomo[ğŸ“ˆ Matomo]
        Tipimail[ğŸ“§ Tipimail]
    end

    Internet[Internet]

    subgraph Kubernetes["â˜¸ Kubernetes"]
        subgraph Plateforme
            GTW[GTW]
            LB[Load Balancer]
            IngressNginx[Ingress Nginx]
        end

        subgraph Applications
            APP["APP (JS)<br/>Jardin mentale<br/>site public"]
            API["API (JS)"]
            Oauth[Oauth]
            Metabase[Metabase]
        end

        subgraph BaseDeDonnees["Bases de donnÃ©es"]
            BDDApp[(PostgreSQL<br/>BDD Applicatif)]
            BDDStats[(PostgreSQL<br/>Jardin mentale<br/>Statistiques)]
        end
    end

    Citoyens --> Internet
    Patients --> AppMobile
    EquipeProduit --> Internet
    AppMobile --> Internet

    Internet --> GTW
    GTW --> LB
    LB --> IngressNginx

    IngressNginx --> APP
    IngressNginx --> API
    IngressNginx --> Oauth

    API --> BDDApp
    API --> Tipimail
    API --> Sentry
    API --> Matomo

    Oauth --> Metabase
    Metabase --> BDDStats

    style Kubernetes fill:#e3f2fd
    style Plateforme fill:#bbdefb
    style Applications fill:#e1f5e1
    style BaseDeDonnees fill:#cce5ff
    style ServicesExternes fill:#fff4e1
```

---

## 9. ARCHITECTURE DE DONNEES

### ModÃ¨le de donnÃ©es principal

La base de donnÃ©es PostgreSQL utilise Prisma ORM avec les modÃ¨les principaux suivants :

#### AnonymisedUser

- Utilisateur anonymisÃ©
- IdentifiÃ© par un UUID
- Token de notification unique

#### Reminder

- Rappel associÃ© Ã  un utilisateur
- Types : Main, Goal, Inactivity
- Gestion fine des jours et heures

#### ReminderUtcDaysOfWeek

- DÃ©tail des jours de la semaine pour chaque rappel
- BoolÃ©ens pour chaque jour

**Relations :**

- Un utilisateur possÃ¨de plusieurs rappels
- Chaque rappel peut avoir une configuration de jours spÃ©cifique

**Index :**

- Index sur les tokens
- Index sur les types
- Index sur les heures (pour optimiser les requÃªtes de rappels)

---

## 10. SERVEURS, COMPOSANTS APPLICATIFS

### [Site Ã©ditorial - APP]

| Attribut         | Valeur    |
| ---------------- | --------- |
| **RÃ´le**         | APP       |
| **Type**         | Conteneur |
| **CPU Requests** | 100m cpu  |
| **CPU Limits**   | 200m cpu  |
| **RAM Requests** | 256 Mo    |
| **RAM Limits**   | 384 Mo    |
| **HPA Status**   | OFF       |
| **HPA min**      | 2         |
| **HPA max**      | 2         |

**Composants :**

| CatÃ©gorie | Composant | Version | RÃ´le |
| --------- | --------- | ------- | ---- |
| APP       | NodeJS    | â€”       | â€”    |

### [Jardin Mentale - Base de donnÃ©es]

| Attribut         | Valeur          |
| ---------------- | --------------- |
| **RÃ´le**         | Base de donnÃ©es |
| **Type**         | Conteneur       |
| **CPU Requests** | 100m cpu        |
| **CPU Limits**   | 1 cpu           |
| **RAM Requests** | 1 Go            |
| **RAM Limits**   | 1 Go            |
| **HPA Status**   | OFF             |
| **HPA min**      | 3               |
| **HPA max**      | 3               |

**Composants :**

| CatÃ©gorie | Composant  | Version | RÃ´le |
| --------- | ---------- | ------- | ---- |
| CNPG      | PostgreSQL | 15      | â€”    |

### [Jardin mentale - APP]

| Attribut         | Valeur    |
| ---------------- | --------- |
| **RÃ´le**         | APP       |
| **Type**         | Conteneur |
| **CPU Requests** | 100m cpu  |
| **CPU Limits**   | 200m cpu  |
| **RAM Requests** | 512 Mo    |
| **RAM Limits**   | 768 Mo    |
| **HPA Status**   | OFF       |
| **HPA min**      | 2         |
| **HPA max**      | 2         |

**Composants :**

| CatÃ©gorie | Composant | Version | RÃ´le |
| --------- | --------- | ------- | ---- |
| APP       | NodeJS    | 20      | â€”    |

### [Jardin mentale - statistiques - Metabase]

| Attribut       | Valeur      |
| -------------- | ----------- |
| **RÃ´le**       | Statistique |
| **Type**       | Conteneur   |
| **HPA Status** | OFF         |
| **HPA min**    | 1           |
| **HPA max**    | 1           |

**Composants :**

| CatÃ©gorie   | Composant | Version | RÃ´le |
| ----------- | --------- | ------- | ---- |
| Statistique | Metabase  | â€”       | â€”    |

### [Jardin mentale - Oauth]

| Attribut       | Valeur           |
| -------------- | ---------------- |
| **RÃ´le**       | Authentification |
| **Type**       | conteneur        |
| **HPA Status** | OFF              |
| **HPA min**    | 1                |
| **HPA max**    | 1                |

**Composants :**

| CatÃ©gorie | Composant   | Version | RÃ´le |
| --------- | ----------- | ------- | ---- |
| APP       | oauth proxy | â€”       | â€”    |

### [Jardin mentale - statistiques - BDD]

| Attribut         | Valeur          |
| ---------------- | --------------- |
| **RÃ´le**         | Base de donnÃ©es |
| **Type**         | Conteneur       |
| **CPU Requests** | 256m cpu        |
| **CPU Limits**   | 512m cpu        |
| **RAM Requests** | 1 Go            |
| **RAM Limits**   | 1 Go            |
| **HPA Status**   | OFF             |
| **HPA min**      | 3               |
| **HPA max**      | 3               |

**Composants :**

| CatÃ©gorie | Composant  | Version | RÃ´le |
| --------- | ---------- | ------- | ---- |
| CNPG      | PostgreSQL | 15      | â€”    |

### [Jardin mentale - statistiques - BSS Sync]

| Attribut         | Valeur                          |
| ---------------- | ------------------------------- |
| **RÃ´le**         | Base de donnÃ©es Synchronisation |
| **Type**         | Conteneur                       |
| **CPU Requests** | 100m cpu                        |
| **CPU Limits**   | 4 cpu                           |
| **RAM Requests** | 1 Go                            |
| **RAM Limits**   | 1Go                             |
| **HPA Status**   | OFF                             |
| **HPA min**      | 1                               |
| **HPA max**      | 1                               |

**Composants :**

| CatÃ©gorie | Composant  | Version | RÃ´le |
| --------- | ---------- | ------- | ---- |
| CNPG      | PostgreSQL | 15      | â€”    |

---

## 11. MATRICES DES FLUX APPLICATIVE ET SYSTEME

### Matrice de flux Applicatif - Site Editorial

| NÂ° Flux | Source | Destination        | Port | Protocole | Commentaires |
| ------- | ------ | ------------------ | ---- | --------- | ------------ |
| 1       | 1P     | Site Jardin mental | 443  | HTTPS     | â€”            |

### Matrice de flux Applicatif - Jardin Mental

| NÂ° Flux | Source | Destination | Port | Protocole | Commentaires |
| ------- | ------ | ----------- | ---- | --------- | ------------ |
| 11      | 1P     | API         | 443  | HTTPS     | â€”            |
| 12      | API    | BDD         | 5432 | PG        | â€”            |
| 16      | API    | TIPIMAIL    | 587  | SMTP      | â€”            |
| 17      | API    | SENTRY      | 443  | HTTPS     | â€”            |

### Matrice de flux Applicatif - Statistiques

| NÂ° Flux | Source      | Destination | Port | Protocole | Commentaires |
| ------- | ----------- | ----------- | ---- | --------- | ------------ |
| 13      | 1P          | oauth proxy | 443  | HTTPS     | â€”            |
| 14      | oauth proxy | metabase    | 443  | HTTPD     | â€”            |
| 15      | metabase    | BDD         | 5432 | PG        | â€”            |

### Matrice de flux plateforme

| NÂ° Flux | Source        | Destination   | Port     | Protocole    | Commentaires |
| ------- | ------------- | ------------- | -------- | ------------ | ------------ |
| 1P      | Internet      | Firewall      | 80 - 443 | HTTP - HTTPS | â€”            |
| 1P      | Firewall      | Load Balancer | 80 - 443 | HTTP - HTTPS | â€”            |
| 1P      | Load Balancer | Ingress NGINX | 80 - 443 | HTTP - HTTPS | â€”            |

---

## URLS ET CERTIFICATS

### URLs Site Jardin Mental

| Attribut                     | Valeur                                       |
| ---------------------------- | -------------------------------------------- |
| **URL**                      | https://jardinmental.fabrique.social.gouv.fr |
| **Equipement portant l'URL** | â€”                                            |
| **Usage**                    | â€”                                            |
| **SSL**                      | Oui                                          |
| **Type certificat**          | â€”                                            |
| **VIP**                      | â€”                                            |
| **LB / RP**                  | Oui                                          |
| **Terminaison SSL**          | â€”                                            |

---

## INFORMATIONS TECHNIQUES COMPLÃ‰MENTAIRES

### Technologies Frontend (Mobile)

- **Framework** : React Native avec Expo
- **Gestionnaire de paquets** : pnpm
- **Plateforme** : iOS et Android
- **Analytics** : Matomo (via logEvents.js)
- **Tests** : Suite de tests automatisÃ©s avec couverture
- **Publication** : Builds locaux, publication manuelle sur App Store et Play Store

### Technologies Backend (API)

- **Runtime** : Node.js
- **Framework** : Express
- **Langage** : TypeScript (migration progressive depuis JavaScript)
- **ORM** : Prisma
- **Base de donnÃ©es** : PostgreSQL 15
- **Monitoring** : Sentry
- **Tests** : Scripts de test automatisÃ©s, type-check

### FonctionnalitÃ©s Backend

- Endpoints REST pour la gestion des utilisateurs, rappels, notifications
- Cron jobs pour l'envoi de rappels et tÃ¢ches rÃ©currentes
- Middlewares pour :
  - Gestion des erreurs
  - Rate limiting
  - VÃ©rification de version
  - SÃ©curitÃ©

### SÃ©curitÃ© et ConformitÃ©

- **Anonymisation** : Aucun identifiant personnel stockÃ©, UUID uniquement
- **Tokens de notification** : StockÃ©s de faÃ§on unique et indexÃ©s
- **Validation** : Typage strict, validation des entrÃ©es
- **Monitoring** : Sentry pour le suivi des erreurs
- **ConformitÃ©** : RGPD, RGS, RGI, RGAA

### DÃ©ploiement

- **Mobile** : Publication via Expo, builds locaux
- **API** : DÃ©ploiement via Docker sur Kubernetes
- **CI/CD** : Tests automatisÃ©s, vÃ©rification de type, couverture
- **Environnements** : Configuration via fichiers d'environnement

---

## LIENS UTILES ET DOCUMENTATION

- [Site officiel](https://jardinmental.fabrique.social.gouv.fr/)
- [Documentation mobile](app/README.md)
- [Documentation API TypeScript](api/README-TypeScript.md)
- [Intentions du projet](https://beta.gouv.fr/startups/monsuivipsy.html)

---

**Document mis Ã  jour le :** 2026-01-30
